<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sheets 데이터 가져오기</title>
    <!-- googleapis 스크립트를 직접 로드합니다. -->
    <script src="https://apis.google.com/js/api.js"></script>
    <style>
        /* CSS 그리드 스타일 설정 */
        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
        }

        .grid-item {
            border: 1px solid #ccc;
            padding: 10px;
        }
    </style>
</head>
<body>
    <div class="grid-container" id="gridContainer"></div>

    <script>
        async function getDataFromGoogleSheets() {
            // 스프레드시트 ID 설정
            const spreadsheetId = '1uSd8_FyftTPUR_bs2iEn3kvH-PLWRNPqWBc5JAKCkUs'; // 스프레드시트 ID로 변경

            // 스프레드시트 데이터를 가져올 범위 설정
            const range = 'Sheet1'; // 시트 이름 또는 범위 설정

            // 스프레드시트 데이터를 가져오기 위한 요청 설정
            const request = {
                spreadsheetId,
                range,
            };

            try {
                // Google API 클라이언트 초기화
                await gapi.client.init({
                    apiKey: 'AIzaSyC_-7rz_p2KqQhm-2oudR38OBgrk-rgmtM', // 실제 API 키로 변경
                    discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
                });

                // Google Sheets API를 사용하여 데이터 가져오기 요청을 보냅니다.
                const response = await gapi.client.sheets.spreadsheets.values.get(request);

                // 요청이 성공하면 데이터를 처리합니다.
                const data = response.result.values;
                if (data.length) {
                    console.log('데이터:');
                    const gridContainer = document.getElementById('gridContainer');
                    // 데이터를 그리드에 적용
                    data.forEach((row) => {
                        const gridItem = document.createElement('div');
                        gridItem.className = 'grid-item';
                        gridItem.textContent = row[0]; // 데이터는 첫 번째 열의 값만 사용
                        gridContainer.appendChild(gridItem);
                    });
                } else {
                    console.log('데이터가 없습니다.');
                }
            } catch (error) {
                console.error('API 오류:', error);
            }
        }

        // gapi 라이브러리를 비동기적으로 로드하고 초기화 함수 호출
        async function loadGoogleAPI() {
            // gapi 라이브러리를 로드합니다.
            await new Promise((resolve) => {
                gapi.load('client', resolve);
            });

            // 초기화 함수 호출
            getDataFromGoogleSheets();
        }

        // loadGoogleAPI 함수 호출하여 Google API 초기화 및 데이터 가져오기 시작
        loadGoogleAPI();
    </script>
</body>
</html>
